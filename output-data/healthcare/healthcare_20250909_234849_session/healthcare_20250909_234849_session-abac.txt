# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(position=patient, uid=oncPat2 ; rid=oncPat2HR ; {addNote} ; )
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR ; {addItem} ; treatingTeam = oncTeam1, patient=oncPat1)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR ; {addItem} ; treatingTeam = carTeam1, patient=carPat1)
rule(position=nurse, ward=carWard ; type=HR ; {addItem} ; patient=carPat2)
rule(position=nurse, ward=oncWard ; type=HR ; {addItem} ; patient=oncPat1)
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2HR ; {addNote} ; )
rule(position=agent, agentFor]{carPat2} ; rid=carPat2noteItem ; {read} ; )
rule(author=oncDoc1 ; rid=oncPat1oncItem ; {read} ; )
rule(position=doctor, specialties]{oncology}, teams]{oncTeam1} ; type=HR ; {addItem} ; patient=oncPat1)
rule(position=patient, uid=oncPat1 ; rid=oncPat1HR ; {addNote} ; )
rule(position=nurse, ward=carWard ; type=HR ; {addItem} ; patient=carPat1)
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2noteItem ; {read} ; )
rule(author=carDoc2 ; rid=carPat2carItem ; {read} ; )
rule(author=carDoc2 ; rid=carPat1carItem ; {read} ; )
rule(position=nurse, ward=carWard ; type=HR ; {addItem} ; patient=carPat1)
rule(oncDoc1 ; type=HRitem ; {read} ; author=oncDoc1, rid=oncPat1oncItem)
rule(position=doctor, specialties]{cardiology}, teams]{carTeam1} ; type=HR ; {addItem} ; patient=carPat1)
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read} ; ward=carWard, patient=carPat1)
rule(position=patient, uid=carPat1 ; rid=carPat1noteItem ; {read} ; )
rule(position=doctor, specialties]{cardiology}, teams]{carTeam2} ; type=HR ; {addItem} ; patient=carPat2)
rule(position=patient, uid=oncPat1 ; rid=oncPat1noteItem ; {read} ; )
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read} ; ward=oncWard, patient=oncPat2)
rule(position=nurse, ward=oncWard ; type=HR ; {addItem} ; patient=oncPat1)
rule(position=patient, uid=carPat1 ; rid=carPat1HR ; {addNote} ; )
rule(author=carNurse1 ; rid=carPat1nursingItem ; {read} ; )
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2HR ; {addNote} ; )
rule(author=doc1 ; rid=oncPat2oncItem ; {read} ; )
rule(position=doctor, specialties]{oncology}, teams]{oncTeam2} ; type=HR ; {addItem} ; patient=oncPat2)
rule(specialties]{oncology}, teams]{oncTeam2} ; rid=oncPat2oncItem ; {read} ; position=doctor)
rule(position=patient, uid=carPat2 ; rid=carPat2HR ; {addNote} ; )
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read} ; ward=oncWard, patient=oncPat1)
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2HR ; {addNote} ; )
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read} ; ward=oncWard, patient=oncPat1)
rule(position=agent, agentFor]{carPat2} ; rid=carPat2HR ; {addNote} ; )
rule(author=oncNurse2 ; rid=oncPat1nursingItem ; {read} ; )
rule(position=agent, agentFor]{carPat2} ; rid=carPat2HR ; {addNote} ; )
rule(position=doctor, specialties]{oncology}, teams]{oncTeam1} ; type=HR ; {addItem} ; patient=oncPat2)
rule(specialties]{oncology}, teams]{oncTeam1} ; rid=oncPat2oncItem ; {read} ; position=doctor)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam2} ; type=HR ; {addItem} ; patient=oncPat2)
rule(position=nurse, ward=oncWard ; type=HR ; {addItem} ; patient=oncPat1)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR ; {addItem} ; patient=carPat1)
rule(position=nurse, ward=oncWard ; type=HR ; {addItem} ; patient=oncPat2)
rule(author=carDoc2 ; rid=carPat1carItem ; {read} ; )
rule(position=nurse, ward=oncWard ; type=HR ; {addItem} ; patient=oncPat2)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam2} ; rid=oncPat2oncItem ; {read} ; )
rule(position=nurse; type=HRitem, topics]{nursing} ; {read} ; ward=carWard, patient=carPat2)
rule(position=doctor, specialties]{cardiology}, teams]{carTeam2} ; type=HR ; {addItem} ; patient=carPat2)
rule(position=nurse, ward=carWard ; type=HR, patient=carPat2 ; {addItem} ; )
rule(position=nurse, ward=oncWard ; type=HR, patient=oncPat2 ; {addItem} ; )
rule(position=nurse, ward=carWard ; type=HR, patient=carPat1 ; {addItem} ; )
rule(position=nurse, ward=oncWard ; type=HR, patient=oncPat1 ; {addItem} ; )
rule(author=anesDoc1; type=HR ; {addItem} ; patient=oncPat1, treatingTeam=oncTeam1)
rule(author=anesDoc1; type=HR ; {addItem} ; patient=carPat1, treatingTeam=carTeam1)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam1}; type=HR ; {addItem} ; patient=oncPat1)
rule(author=oncDoc1; type=HRitem ; {read} ; rid=oncPat1oncItem)
rule(position=patient, uid=oncPat1 ; rid=oncPat1HR ; {addNote} ; )
rule(position=doctor, specialties]{cardiology}, teams]{carTeam1}; type=HR ; {addItem} ; patient=carPat1)
rule(author=carNurse1; type=HRitem; {read} ; rid=carPat1nursingItem)
rule(position=patient, uid=carPat1 ; rid=carPat1noteItem ; {read} ; )
rule(author=doc1; type=HRitem; {read} ; rid=oncPat2oncItem)
rule(specialties]{oncology}, teams]{oncTeam2} ; rid=oncPat2oncItem ; {read} ; position=doctor)
rule(author=carDoc2; type=HRitem; {read} ; rid=carPat1carItem)
rule(specialties]{cardiology}, teams]{carTeam2}; type=HR; {addItem} ; patient=carPat2)
rule(position=agent, agentFor]{carPat2} ; rid=carPat2noteItem ; {read} ; )
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2noteItem ; {read} ; )
rule(position=patient, uid=carPat2 ; rid=carPat2HR ; {addNote} ; )
rule(position=patient, uid=oncPat2 ; rid=oncPat2HR ; {addNote} ; )
rule(position=agent, agentFor]{carPat2} ; rid=carPat2HR ; {addNote} ; )
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2HR ; {addNote} ; )
rule(author=oncNurse2; type=HRitem ; {read} ; rid=oncPat1nursingItem)
rule(position=patient, uid=carPat1 ; rid=carPat1HR ; {addNote} ; )
rule(position=patient, uid=oncPat1 ; rid=oncPat1noteItem ; {read} ; )
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=carPat1, ward=carWard)
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=oncPat2, ward=oncWard)
rule(author=carDoc2; type=HRitem; {read} ; rid=carPat2carItem)
rule(author=doc2; type=HRitem; {read} ; rid=carPat2carItem)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR; {addItem} ; patient=carPat1, treatingTeam=carTeam1)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR; {addItem} ; patient=oncPat1, treatingTeam=oncTeam1)
rule(ward=oncWard ; type=HR, patient=oncPat1 ; {addItem} ; position=nurse)
rule(ward=carWard ; type=HR, patient=carPat1 ; {addItem} ; position=nurse)
rule(author=oncDoc1 ; type=HRitem, patient=oncPat1 ; {read} ; topics]{oncology})
rule(author=carDoc2 ; type=HRitem, patient=carPat1 ; {read} ; topics]{cardiology})
rule(position=doctor, specialties]{oncology}, teams]{oncTeam2} ; type=HR ; {addItem} ; patient=oncPat2)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam1}; type=HR ; {addItem} ; patient=oncPat1)
rule(ward=carWard ; type=HR, patient=carPat2 ; {addItem} ; position=nurse)
rule(ward=oncWard ; type=HR, patient=oncPat2 ; {addItem} ; position=nurse)
rule(author=carNurse1 ; type=HRitem ; {read} ; rid=carPat1nursingItem)
rule(author=oncNurse2 ; type=HRitem ; {read} ; rid=oncPat1nursingItem)
rule(author=doc1 ; type=HRitem ; {read} ; rid=oncPat2oncItem)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR; {addItem} ; patient=carPat1, treatingTeam=carTeam1)
rule(position=doctor, specialties]{anesthesiology}, teams]{oncTeam1 carTeam1} ; type=HR; {addItem} ; patient=oncPat1, treatingTeam=oncTeam1)
rule(type=HRitem ; {read} ; author=oncDoc1, rid=oncPat1oncItem)
rule(author=carDoc2; type=HRitem; {read} ; rid=carPat2carItem)
rule(author=doc2; type=HRitem; {read} ; rid=carPat2carItem)
rule(ward=carWard ; type=HR, patient=carPat2 ; {addItem} ; position=nurse)
rule(ward=oncWard ; type=HR, patient=oncPat2 ; {addItem} ; position=nurse)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam2}; type=HR ; {addItem} ; patient=oncPat2)
rule(author=anesDoc1; type=HR ; {addItem} ; patient=carPat1, treatingTeam=carTeam1)
rule(author=anesDoc1; type=HR ; {addItem} ; patient=oncPat1, treatingTeam=oncTeam1)
rule(author=oncDoc1 ; type=HRitem, patient=oncPat1 ; {read} ; topics]{oncology})
rule(author=carDoc2 ; type=HRitem, patient=carPat1 ; {read} ; topics]{cardiology})
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=carPat1, ward=carWard)
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=oncPat2, ward=oncWard)
rule(position=doctor, specialties]{oncology}, teams]{oncTeam1}; type=HR ; {addItem} ; patient=oncPat1)
rule(type=HRitem ; {read} ; author=oncDoc1, patient=oncPat1, topics]{oncology})
rule(position=agent, agentFor]{carPat2} ; rid=carPat2noteItem ; {read} ; )
rule(position=agent, agentFor]{oncPat2} ; rid=oncPat2noteItem ; {read} ; )
rule(author=doc2 ; type=HRitem, patient=carPat2 ; {read} ; topics]{cardiology})
rule(position=agent, agentFor]{carPat2} ; type=HR ; {addNote} ; patient=carPat2)
rule(position=agent, agentFor]{oncPat2} ; type=HR ; {addNote} ; patient=oncPat2)
rule(type=HRitem; {read} ; author=carNurse1, patient=carPat1, topics]{nursing})
rule(position=patient, uid=carPat1 ; rid=carPat1noteItem ; {read} ; )
rule(type=HRitem ; {read} ; author=oncNurse2, patient=oncPat1, topics]{nursing})
rule(position=patient, uid=carPat1 ; type=HR ; {addNote} ; patient=carPat1)
rule(position=patient, uid=oncPat1 ; type=HR ; {addNote} ; patient=oncPat1)
rule(position=agent, agentFor]{carPat2} ; type=HRitem ; {read} ; topics]{note}, patient=carPat2)
rule(position=agent, agentFor]{oncPat2} ; type=HRitem ; {read} ; topics]{note}, patient=oncPat2)
rule(position=agent, agentFor]{carPat2} ; type=HR, patient=carPat2 ; {addNote} ; )
rule(position=agent, agentFor]{oncPat2} ; type=HR, patient=oncPat2 ; {addNote} ; )
rule(ward=oncWard ; type=HR, patient=oncPat2 ; {addItem} ; position=nurse)
rule(ward=carWard ; type=HR, patient=carPat1 ; {addItem} ; position=nurse)
rule(type=HRitem ; {read} ; author=oncDoc1, patient=oncPat1, topics]{oncology})
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=carPat1, ward=carWard)
rule(position=nurse ; type=HRitem, topics]{nursing} ; {read}; patient=oncPat2, ward=oncWard)
rule(type=HRitem; {read} ; author=carNurse1, patient=carPat1, topics]{nursing})
rule(type=HRitem ; {read} ; author=oncNurse2, patient=oncPat1, topics]{nursing})
rule(author=doc2 ; type=HRitem, patient=carPat2 ; {read} ; topics]{cardiology})
