
===============================================================
ITERATION : 4
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(agentFor ] carPat2; type=HRitem, topics ] {note}, patient=carPat2; {read};)
rule(position=nurse, ward=oncWard; type=HRitem, topics ] {nursing}, patient=oncPat2; {read};)
rule(position=nurse, ward=oncWard; type=HR, ward=oncWard; {addItem};)
rule(position=nurse, ward=carWard; type=HRitem, topics ] {nursing}, patient=carPat1; {read};)
rule(position=nurse, ward=carWard; type=HR, ward=carWard; {addItem};)
rule(position=patient, ward=carWard; type=HRitem, topics ] {note}, patient=carPat1; {read};)
rule(position=patient, ward=carWard; type=HR, patient=carPat1; {addNote};)
rule(position=patient, ward=oncWard; type=HR, patient=oncPat1; {addNote};)
rule(specialties ] {oncology pediatrics}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read};)
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read};)
rule(specialties ] {cardiology neurology}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read};)
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=carPat1; {addItem};)
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read};)
rule(agentFor ] oncPat2; type=HRitem, topics ] {note}, patient=oncPat2; {read};)
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read};)
rule(author=oncDoc1; type=HRitem, patient=oncPat1, topics ] {oncology}; {read};)
rule(agentFor ] oncPat2; type=HR, patient=oncPat2; {addNote};)
rule(agentFor ] carPat2; type=HR, patient=carPat2; {addNote};)
rule(author=oncPat1; type=HRitem, topics ] {note}, patient=oncPat1; {read};)
rule(author=oncNurse2; type=HRitem, topics ] {nursing}, patient=oncPat1; {read};)
===============================================================
ITERATION : 3
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(agentFor ] oncPat2; type=HRitem, topics ] {note}, patient=oncPat2; {read};)
rule(agentFor ] carPat2; type=HRitem, topics ] {note}, patient=carPat2; {read};)
rule(position=nurse, ward=oncWard; type=HRitem, topics ] {nursing}, patient=oncPat2; {read};)
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat1; {addItem};)
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat2; {addItem};)
rule(position=nurse, ward=carWard; type=HRitem, topics ] {nursing}, patient=carPat2; {read};)
rule(position=nurse, ward=carWard; type=HR, patient=carPat1; {addItem};)
rule(position=nurse, ward=carWard; type=HR, patient=carPat2; {addItem};)
rule(position=patient, ward=carWard; type=HRitem, topics ] {note}, patient=carPat1; {read};)
rule(position=patient, ward=carWard; type=HR, patient=carPat1; {addNote};)
rule(position=patient, ward=oncWard; type=HR, patient=oncPat1; {addNote};)
rule(specialties ] {oncology pediatrics}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read};)
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read};)
rule(specialties ] {cardiology neurology}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read};)
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=carPat1; {addItem};)
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read};)
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HR, patient=carPat1; {addItem};)
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HR, patient=carPat2; {addItem};)
rule(agentFor ] oncPat2; type=HR, patient=oncPat2; {addNote};)
rule(agentFor ] carPat2; type=HR, patient=carPat2; {addNote};)
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HR, patient=oncPat1; {addItem};)
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read};)
rule(specialties ] {oncology}, teams ] {oncTeam2}; type=HR, patient=oncPat2; {addItem};)
===============================================================
ITERATION : 2
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(position=patient, ward=carWard; type=HR, patient=carPat1; {addNote}; )
rule(agentFor ] oncPat2; type=HR, patient=oncPat2; {addNote}; )
rule(agentFor ] carPat2; type=HR, patient=carPat2; {addNote}; )
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat1; {addItem}; )
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat2; {addItem}; )
rule(position=nurse, ward=carWard; type=HR, patient=carPat1; {addItem}; )
rule(position=nurse, ward=carWard; type=HR, patient=carPat2; {addItem}; )
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(specialties ] {oncology}, teams ] {oncTeam2}; type=HR, patient=oncPat2; {addItem}; )
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HR, patient=carPat2; {addItem}; )
rule(ward=oncWard; type=HRitem, author=oncNurse2, patient=oncPat1, topics ] {nursing}; {read}; )
rule(ward=oncWard; type=HRitem, author=oncNurse1, patient=oncPat2, topics ] {nursing}; {read}; )
rule(ward=carWard; type=HRitem, author=carNurse1, patient=carPat1, topics ] {nursing}; {read}; )
rule(ward=carWard; type=HRitem, author=carNurse2, patient=carPat2, topics ] {nursing}; {read}; )
rule(specialties ] {oncology pediatrics}; type=HRitem, author=doc1, patient=oncPat2, topics ] {oncology}; {read}; )
rule(specialties ] {cardiology neurology}; type=HRitem, author=doc2, patient=carPat2, topics ] {cardiology}; {read}; )
rule(agentFor ] oncPat2; type=HRitem, topics ] {note}, patient=oncPat2; {read}; )
rule(agentFor ] carPat2; type=HRitem, topics ] {note}, patient=carPat2; {read}; )
rule(position=patient, ward=carWard; type=HRitem, topics ] {note}, patient=carPat1; {read}; )
rule(position=doctor, specialties ] {oncology}, teams ] {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read}; )
rule(ward=carWard; position=doctor, specialties ] {cardiology}, teams ] {carTeam2}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read}; )
rule(position=patient, ward=oncWard; type=HR, patient=oncPat1; {addNote}; )
rule(position=doctor, specialties ] {oncology}, teams ] {oncTeam2}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read}; )

===============================================================
ITERATION : 1
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(type=HRitem, topics ] {note}, patient=carPat1; position=patient, ward=carWard; {read}; )
rule(type=HRitem, topics ] {note}, patient=oncPat1; position=patient, ward=oncWard; {read}; )
rule(agentFor ] oncPat2; type=HR, patient=oncPat2; {addNote}; )
rule(agentFor ] oncPat2; type=HRitem, topics ] {note}, patient=oncPat2; {read}; )
rule(agentFor ] carPat2; type=HRitem, topics ] {note}, patient=carPat2; {read}; )
rule(agentFor ] carPat2; type=HR, patient=carPat2; {addNote}; )
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat1; {addItem}; )
rule(position=nurse, ward=oncWard; type=HR, patient=oncPat2; {addItem}; )
rule(position=nurse, ward=carWard; type=HR, patient=carPat1; {addItem}; )
rule(position=nurse, ward=carWard; type=HR, patient=carPat2; {addItem}; )
rule(position=doctor, specialties ] {oncology}, teams ] {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(position=doctor, specialties ] {oncology}, teams ] {oncTeam2}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(specialties ] {oncology pediatrics}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read}; )
rule(specialties ] {cardiology neurology}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read}; )
rule(position=doctor, specialties ] {cardiology}, teams ] {carTeam1 carTeam2}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read}; )
rule(type=HR, patient=carPat2; position=patient, ward=carWard; {addNote}; )
rule(type=HR, patient=oncPat1; position=patient, ward=oncWard; {addNote}; )
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(specialties ] {oncology}, teams ] {oncTeam2}; type=HR, patient=oncPat2; {addItem}; )
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(specialties ] {anesthesiology}, teams ] {oncTeam1 carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HR, patient=carPat2; {addItem}; )
rule(; type=HRitem, author=oncNurse2, patient=oncPat1, topics ] {nursing}; {read}; )
rule(; type=HRitem, author=oncNurse1, patient=oncPat2, topics ] {nursing}; {read}; )
rule(; type=HRitem, author=carNurse1, patient=carPat1, topics ] {nursing}; {read}; )
rule(; type=HRitem, author=carNurse2, patient=carPat2, topics ] {nursing}; {read}; )
rule(; type=HRitem, author=doc1, patient=oncPat2, topics ] {oncology}; {read}; )
rule(; type=HRitem, author=doc2, patient=carPat2, topics ] {cardiology}; {read}; )
rule(specialties ] {cardiology}, teams ] {carTeam2}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read}; )
rule(specialties ] {cardiology}, teams ] {carTeam1}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read}; )
rule(specialties ] {oncology}, teams ] {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(specialties ] {oncology}, teams ] {oncTeam2}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read}; )

===============================================================
ITERATION : 0
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

rule(position=nurse, ward [ {oncWard}; type=HRitem, patient=oncPat1; {read}; )
rule(position=doctor, specialties ] {oncology}, teams [ {oncTeam1 oncTeam2}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(position=doctor, specialties ] {oncology}, teams [ {oncTeam1}; type=HRitem, patient=oncPat1, topics ] {oncology}; {read}; )
rule(position=nurse, ward [ {oncWard}; type=HRitem, patient=oncPat2, topics ] {nursing}; {read}; )
rule(position=nurse, ward [ {carWard}; type=HRitem, patient=carPat1, topics ] {nursing}; {read}; )
rule(position=nurse, ward [ {carWard}; type=HRitem, patient=carPat2, topics ] {nursing}; {read}; )
rule(position=patient, ward=oncWard; type=HRitem, patient=oncPat1, topics ] {note}; {read}; )
rule(position=patient, ward=carWard; type=HRitem, patient=carPat1, topics ] {note}; {read}; )
rule(agentFor ] oncPat2; type=HRitem, patient=oncPat2, topics ] {note}; {read}; )
rule(agentFor ] carPat2; type=HRitem, patient=carPat2, topics ] {note}; {read}; )
rule(specialties ] {cardiology}, teams [ {carTeam1 carTeam2}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read}; )
rule(specialties ] {cardiology}, teams [ {carTeam1}; type=HRitem, patient=carPat1, topics ] {cardiology}; {read}; )
rule(specialties ] {cardiology}, teams [ {carTeam2}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read}; )
rule(specialties ] {oncology pediatrics}; type=HRitem, patient=oncPat2, topics ] {oncology}; {read}; )
rule(specialties ] {cardiology neurology}; type=HRitem, patient=carPat2, topics ] {cardiology}; {read}; )
rule(position=nurse, ward [ {oncWard}; type=HR, patient=oncPat1; {addItem}; )
rule(position=nurse, ward [ {oncWard}; type=HR, patient=oncPat2; {addItem}; )
rule(position=nurse, ward [ {carWard}; type=HR, patient=carPat1; {addItem}; )
rule(position=nurse, ward [ {carWard}; type=HR, patient=carPat2; {addItem}; )
rule(position=doctor, specialties ] {oncology}, teams [ {oncTeam1 oncTeam2}; type=HR, patient=oncPat1; {addItem}; )
rule(position=doctor, specialties ] {oncology}, teams [ {oncTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(position=doctor, specialties ] {oncology}, teams [ {oncTeam2}; type=HR, patient=oncPat2; {addItem}; )
rule(position=doctor, specialties ] {cardiology}, teams [ {carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(position=doctor, specialties ] {anesthesiology}, teams [ {oncTeam1 carTeam1}; type=HR, patient=oncPat1; {addItem}; )
rule(position=doctor, specialties ] {anesthesiology}, teams [ {oncTeam1 carTeam1}; type=HR, patient=carPat1; {addItem}; )
rule(position=doctor, specialties ] {cardiology}, teams [ {carTeam2}; type=HR, patient=carPat2; {addItem}; )
rule(position=patient, ward=oncWard; type=HR, patient=oncPat1; {addNote}; )
rule(agentFor ] oncPat2; type=HR, patient=oncPat2; {addNote}; )
rule(position=patient, ward=carWard; type=HR, patient=carPat2; {addNote}; )
rule(agentFor ] carPat2; type=HR, patient=carPat2; {addNote}; )
rule(position=patient, ward=oncWard; type=HR, patient=oncPat2; {addNote}; )
