#------------------------------------------------------------
# ABAC Rules
#------------------------------------------------------------

# 1. An Unregistered Receiver can only view documents sent to them.
rule(role [ {customer}, registered [ {False}; ; {view}; uid [ recipients)

# 2. Helpdesk members can search and view meta-information of documents in the application.
rule(role [ {helpdesk}; ; {search readMetaInfo}; uid [ recipients)

# 3. Helpdesk members can only read the content of documents belonging to tenants they are assigned responsible.
rule(role [ {helpdesk}; isConfidential [ {False}; {view}; tenant = tenant)

# 4. Application admins can view documents that are not confidential.
rule(role [ {admin}; isConfidential [ {False}; {view}; )

# 5. A supervisor can read documents sent by their supervisees.
rule(role [ {employee}, registered [ {True}, tenant [ {largeBank}; ; {view}; supervisee ] owner)

# 6. A project member can read all sent documents related to the project.
rule(role [ {employee}, tenant [ {largeBank}; ; {view}; projects ] rid)

# 7. Only members of the sales department can send, view, or search invoices.
rule(role [ {employee}, department [ {largeBankSales}; type [ {invoice}; {send view search}; )

# 8. Only members of the ICT department can send banking notes and view their status.
rule(role [ {employee}, department [ {largeBankICT}; type [ {bankingNote}; {send readMetaInfo}; )

# 9. Only employees responsible for payrolling can send and view paychecks.
rule(role [ {employee}, tenant [ {largeBank}, payrollingPermissions [ {True}; type [ {paycheck}; {send view}; )

# 10. Only sales department members can send sales offers.
rule(role [ {employee}, department [ {largeBankSales}; type [ {salesOffer}; {send}; )

# 11. Only the bank office manager can send documents.
rule(role [ {employee}, tenant [ {largeBank}, position [ {officeManager seniorOfficeManager}; ; {send}; )

# 12. Audit department members can read all invoices, offers, and documents except those containing personal information.
rule(role [ {employee}, department [ {largeBankAudit}; type [ {invoice salesOffer}, containsPersonalInfo [ {False}; {view}; )

# 13. Only members of Customer Care can view traffic fines.
rule(role [ {employee}, department [ {largeBankLeasingCustomerCare}; type [ {trafficFine}; {view}; )

# 14. Only sales users can send invoices.
#     Only Customer Care Office members can manually bill a customer.
rule(role [ {employee}, department [ {largeBankLeasingSales largeBankLeasingCustomerCare}; type [ {invoice}; {send}; )

# 15. Only the secretary and office director can read documents sent to the bank office.
rule(role [ {employee}, position [ {secretary director}; ; {view}; office = office)

# 16. Any member of the Accounting department can receive and read invoices.
rule(role [ {customer}, department [ {carLeaserAccounting}; type [ {invoice}; {view}; )

# 17. Only secretary members can read invoices.
rule(role [ {customer}, department [ {ictProviderSecretary}; type [ {invoice}; {view}; )

# 18. Audit department members can read all invoices, offers, contracts, and paychecks.
rule(role [ {employee}, department [ {newsAgencyAudit}; type [ {invoice salesOffer contract paycheck}; {view}; )

# 19. Only members of the HR department can send contracts.
rule(role [ {employee}, department [ {europeRegionHR}; type [ {contract}; {send}; )

# 20. Members of the Human Resources department can send contracts.
rule(role [ {employee}, department [ {londonOfficeHR}; type [ {contract}; {send}; )

# 21. Any member of the Sales department can send invoices.
rule(role [ {employee}, department [ {londonOfficeSales}; type [ {invoice}; {send}; )

# 22. Any member of the Sales department can read all invoices sent by the department.
rule(role [ {employee}, department [ {londonOfficeSales}; type [ {invoice}; {view}; department = department)

# 23. Only assigned Customer department members can read a subtenant's documents.
rule(role [ {employee}, department [ {resellerCustomer}; ; {view}; uid [ recipients)

# 24. Any member of the Accounting department can send invoices.
rule(role [ {employee}, department [ {resellerAccounting}; type [ {invoice}; {send}; )

# 25. Registered Private Receivers can only read documents they received.
rule(role [ {customer}, tenant [ {privateReceiver}; ; {view}; uid [ recipients)

